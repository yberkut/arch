# Arch 2.3. Restic –¥–ª—è –±–µ–∫–∞–ø—ñ–≤ –Ω–∞ HDD (NTFS)

## –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è `restic`:

```bash
sudo pacman -S restic
```

–ú–æ–Ω—Ç—É—î–º–æ HDD (NTFS):
[Arch 2.1. –ú–æ–Ω—Ç—É–≤–∞–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ HDD (NTFS) –¥–ª—è –±–µ–∫–∞–ø—ñ–≤](https://github.com/yberkut/arch/blob/main/Arch-2-1--Mount-external-HDD-for-Backups-ua.md)

–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
restic init --repo /mnt/backup/restic-repo
```

**–í–∞–∂–ª–∏–≤–æ!** restic –ø–æ–ø—Ä–æ—Å–∏—Ç—å –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å, —è–∫–∏–π –ø–æ—Ç—ñ–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è.

---

## –®–≤–∏–¥–∫–∏–π —Ä–µ—Ñ–µ—Ä–µ–Ω—Å

[Restic CheatSheet](https://github.com/yberkut/arch/blob/main/Restic-CheatSheet-ua.md)

---

### 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–µ–∫–∞–ø—ñ–≤

#### –ü–æ–≤–Ω–∏–π –±–µ–∫–∞–ø (`/` –∫—Ä—ñ–º –∑–∞–π–≤–∏—Ö –ø–∞–ø–æ–∫) –∑ —Ç–µ–≥–æ–º `full`

```bash
restic backup / --repo /mnt/backup/restic-repo --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found","/swapfile"} --tag full
```

‚úÖ **–©–æ —Ç—É—Ç –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è?**

- `backup /` ‚Üí –ö–æ–ø—ñ—é—î –≤—Å—é —Å–∏—Å—Ç–µ–º—É.
- `--exclude={...}` ‚Üí –ü—Ä–æ–ø—É—Å–∫–∞—î –¥–∏–Ω–∞–º—ñ—á–Ω—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó (–≤–æ–Ω–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è).
- `--tag` –¥–æ–∑–≤–æ–ª—è—î –ø–æ–∑–Ω–∞—á–∞—Ç–∏ –±–µ–∫–∞–ø–∏ –º—ñ—Ç–∫–∞–º–∏, —â–æ–± –ø–æ—Ç—ñ–º —ó—Ö –∑—Ä—É—á–Ω–æ —à—É–∫–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏.

#### –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∏–π –±–µ–∫–∞–ø

`restic` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥—Å—Ç–µ–∂—É—î –∑–º—ñ–Ω–∏, —Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞—î–º–æ —Ç—É –∂ –∫–æ–º–∞–Ω–¥—É:

```bash
restic backup / --repo /mnt/backup/restic-repo --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found","/swapfile"} --tag full
```

üí° **restic –∑–±–µ—Ä—ñ–≥–∞—î —Ç—ñ–ª—å–∫–∏ –∑–º—ñ–Ω–∏**, —Ç–æ–∂ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø—É—Å–∫–∏ –±—É–¥—É—Ç—å —à–≤–∏–¥—à—ñ.

---

### 2. –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–Ω–∞–ø—à–æ—Ç–∞–º–∏

#### –ü–µ—Ä–µ–≥–ª—è–¥ –≤—Å—ñ—Ö –±–µ–∫–∞–ø—ñ–≤

```bash
restic snapshots --repo /mnt/backup/restic-repo
```

#### –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –±–µ–∫–∞–ø—ñ–≤

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ª–∏—à–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ 3 –æ—Å—Ç–∞–Ω–Ω—ñ—Ö:

```bash
restic forget --keep-last 3 --prune --repo /mnt/backup/restic-repo
```

‚úÖ **`--prune` –≤–∏–¥–∞–ª—è—î –∑–∞–π–≤—ñ —Ñ–∞–π–ª–∏ —Ç–∞ –∑–≤—ñ–ª—å–Ω—è—î –º—ñ—Å—Ü–µ**.

---

### 3. –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –±–µ–∫–∞–ø—É

#### –î–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

–ú–æ–∂–µ—à –∑–º–æ–Ω—Ç—É–≤–∞—Ç–∏ –±–µ–∫–∞–ø —ñ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏:

```bash
mkdir /mnt/restic-mount
restic mount /mnt/restic-mount --repo /mnt/backup/restic-repo
```

–¢–µ–ø–µ—Ä —É `/mnt/restic-mount/` –±—É–¥—É—Ç—å –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –±–µ–∫–∞–ø–∏.

#### –ü–æ–≤–Ω–µ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è (`/`)

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ! –ü–µ—Ä–µ–¥ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è–º –∑–∞–≤–∞–Ω—Ç–∞–∂—Å—è –≤ live-—Ä–µ–∂–∏–º!**

```bash
restic restore latest --target /mnt/root --repo /mnt/backup/restic-repo
```

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å–Ω–∞–ø—à–æ—Ç:

```bash
restic restore [SNAPSHOT_ID] --target /mnt/root --repo /mnt/backup/restic-repo
```

---

### –í–∏—Å–Ω–æ–≤–æ–∫

- **–ü–æ–≤–Ω–∏–π –±–µ–∫–∞–ø:** `restic backup /`
- **–Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∏–π:** —Ä–æ–±–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É.
- **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–µ–∫–∞–ø—ñ–≤:** `restic snapshots`
- **–û—á–∏—â–µ–Ω–Ω—è:** `restic forget --keep-last 3 --prune`
- **–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è:** `restic restore latest --target /mnt/root`

---

–¶–µ –¥–∞—î **–ø–æ–≤–Ω—É —ñ—Å—Ç–æ—Ä—ñ—é –∑–º—ñ–Ω** —ñ –¥–æ–∑–≤–æ–ª—è—î **–ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –∞–±–æ –æ–∫—Ä–µ–º—ñ —Ñ–∞–π–ª–∏**.
